\chapter{绪论}
近年来，量子计算因其在特定问题上相比经典计算提供的指数级加速能力而成为科技领域的焦点。随着量子计算技术的迅猛发展，确保量子系统和算法的正确性与可靠性成为了迫切需要解决的问题。此外，物理量子计算机中量子比特数量的快速增长，也对验证方法提出了更为自动化的需求。

模型检测（Model Checking）作为一种自动化的形式化方法，专门用于验证有限状态系统是否满足特定性质。这种方法最初由 E. M. Clarke 和 E. A. Emerson 提出
\citep{Emerson_1980,Clarke,Clarke_1986}，并已在经典计算机的软件和硬件设计中得到广泛应用。例如，嵌入式系统设计中常用 UML (Unified Modeling Language) 活动图来确保硬件设计符合预定规范\citep{Grobelna_2015}。
在量子计算领域，量子模型检测同样展现出其验证量子系统行为的潜力，特别是在可达性分析方面。本次研究将重点探讨量子模型检测在解决量子系统验证问题上的应用，特别是采用张量决策图（Tensor Decision Diagrams, 或TDD）作为核心技术的研究。


\section{研究背景与研究问题}
\subsection{研究背景}
“量子”概念最早由Max Planck在1900年提出，开启了量子物理学的先河\citep{planck1901law}。20世纪20年代，量子理论的发展为波粒二象性提供了理论基础，奠定了现代物理学的基石
\citep{bhatta2020plurality}。
经历两次世界大战期间，不仅促进了计算理论的飞速发展，如图灵机的提出\citep{hodges2014alan}，也加速了量子理论在核物理学等领域的应用\citep{maartensson2006manhattan}。

随着物理学家将量子力学模型应用于计算问题并将经典比特替换为量子比特，量子力学和计算机科学领域开始融合。 1980年，Paul Benioff基于量子理论提出了量子图灵机的概念，为量子计算奠定了理论基础\citep{benioff1980computer}。随着经典计算机在模拟量子动力学过程中遇到的计算限制，Yuri Manin和Richard Feynman分别提出，利用量子现象的计算模型可能更为高效\citep{Feynman,manin1980vychislimoe}。此外， Charles Bennett 和 Gilles Brassard在1984年提出量子密钥分发，进一步展示了量子理论在加强信息安全性方面的潜力\citep{bennett2014quantum}。


进入90年代，量子计算的发展迎来了新的突破。Peter Shor的算法证明了量子计算机在破解传统加密方面的潜力\citep{Shor} 。该算法是量子算法发展史上重要的里程碑之一，向人们证明了量子计算对实际问题的加速能力。之后Grover的算法为解决非结构化搜索问题提供了量子加速的可能\citep{Grover_1996} 。同时，Seth Lloyd 证明量子计算机可以模拟量子系统，而无需经典模拟中存在的指数开销\citep{lloyd1996universal}， 验证了费曼 1982 年的猜想\citep{cao2019quantum}。

多年来，实验学家利用各种可能的技术路线构建小型量子计算机。 1998年，两个量子比特的量子计算机证明了该技术的可行性\citep{chuang1998experimental}。2007
年，加拿大DWave公司展示了一台具有16个量子比特位处理器原型
的绝热量子计算机(Quantum Annealing)“Orion”。2011年，DWave官宣发布了全球第
一款商用型量子计算机“D-Wave One”，其构建了128个量子比特，声称用来解
决最优化问题。
2019 年，Google AI 和 NASA 宣布他们已经通过有54 量子比特的超导量子计算机上实现了量子霸权(Quantum Supermacy)，执行了任何经典计算机都无法完成的计算\citep{arute2019quantum}。尽管，这一说法的有效性需要更多研究\citep{pednault2019quantum}。但这样的说法极大增强了人们对量子计算机的热情，促进了各国政府与私人机构对该领域的投资。

近几年，物理量子计算机已经开始尝试规模化拓展及容错计算。以2023年为例，接下来列举一些比较重要的硬件发展。在国际方面：
\begin{enumerate}
    \item IBM公司宣布成功开发出了名为“Condor”的超导量子处理器，该处理器拥有1121个量子比特的运算能力。
    \item IonQ 在钡离子阱平台上，实现了29个算法量子比特的重大成就，展现了离子阱技术在量子计算中的应用潜力。
    \item Atom Computing 推出了第二代中性原子量子计算平台，具备1180个量子比特。
\end{enumerate}
2023年国内方面：
\begin{enumerate}
    \item 中国科学技术大学 的团队成功构建了“九章三号”光量子计算机，该计算机成功实现了255个光子的量子计算能力。
    \item 北京量子信息科学研究院、中科院物理研究所和清华大学共同研发推出了“夸父”超导量子云平台，其后端最高接入了136比特超导量子芯片。
\end{enumerate}

随着量子计算领域的快速发展，对量子系统的可靠性提出了更多需要，对应的验证需求也在不断增长。经典的形式化验证技术，如模型检测(Model Checking)和定理证明(Theorem Proving)，虽然成熟但面临新挑战。模型检测技术通过逻辑公式检测状态迁移系统的行为，虽然自动化程度高，但存在状态空间爆炸问题。定理证明通过数学逻辑来验证系统模型，尽管在处理复杂问题时具有优势，但需要人的干预，自动化程度低。
\subsection{研究的问题}
% \begin{itemize}
%   \item 可达性分析
%   \item 模型检验的挑战
% \end{itemize}
随着量子计算硬件的发展，量子系统将越来越复杂。自动化程度低，需要大量人力参与的定理证明方法将难以应对。因此本研究中采用的主要方法是量子模型检测。
而在量子模型检测领域，存在一个关键挑战，即状态空间爆炸问题。量子计算的状态空间\(\mathcal{H}\)维度\(dim\left(\mathcal{H}\right)=2^n\)，其中n为比特数量。随着比特数量的增加，状态空间的维数会指数级地增长，这极大地增加了应用模型检测来验证量子系统属性的复杂度。

为应对这一挑战，可以引入更高效的数据结构，以较少的资源表示量子状态和量子线路，并计算其最终结果。特别地，张量决策图（TDD）为量子电路提供了一种紧凑的表示形式，它便于实现张量网络的各种操作，这对模拟量子物理系统至关重要。如图 \ref{fig:P} 所示，通过比较矩阵形式和TDD形式的表示，可以明显看出TDD结构的紧凑性，其中TDD中实线代表高边，虚线代表低边。
 	 
\begin{figure}[!htbp]
    \begin{subfigure}[c]{0.4\textwidth}
        \centering
        \includegraphics[width=1.2\textwidth]{Img/matrix_of_tdd.pdf}
        \caption{矩阵$P$的矩阵形式}
        \label{fig:mat_P}
    \end{subfigure}
    \begin{subfigure}[c]{0.4\textwidth}
        \centering
        \includegraphics[height=7cm]{Img/tdd_ex.pdf}
        \caption{矩阵$P$的TDD形式}
        \label{fig:tdd_P}
    \end{subfigure}
    \caption{应用TDD可以减少存储特殊矩阵的资源}
    \label{fig:P}
\end{figure}

TDD尤其适合于实施可达性分析和模型检查算法。这得益于在基于BDD（二进制决策图）的模型检查算法中使用的许多优化技术，可推广至TDD用于收缩量子电路的张量网络\citep{Chaki_2018}。这一技术进步为利用TDD解决量子模型检测问题提供了新的可能性。

在模型检测中，可达性、持续可达性以及重复可达性构成了三个重要的可达性问题类别。因此，本研究旨在借助TDD数据结构，开发一种能够快速计算量子模型检测中可达性问题的高效方案。

\section{研究现状与相关工作}
量子模型检测的早期工作集中在验证量子通信协议。随着量子计算的不断发展，逐渐出现了对量子程序的验证工具。
如今量子模型检测又集中在了电路验证方面的工作。
在整个量子模型检测的发展过程中，我国国内的研究者Mingsheng Ying, Yuan Feng 等人深入参与并深刻影响了该领域的研究。

量子模型检测的早期工作旨在验证量子通信协议。由于量子叠加态的特殊性质，量子测量带有概率性。因此David Parker等人采用概率模型检测工具PRISM\citep{kwiatkowska2004probabilistic}来验证量子协议的正确性，如超密编码、量子传输和量子纠错等。
之后在引入外源量子命题逻辑(Exogenous Quantum Propositional Logic，或EQPL)\citep{mateus2006weakly}的基础上，Pedro Baltazar等人研究了量子计算树逻辑(Quantum Computation Tree Logic，或QCTL)模型检测问题，并验证了量子密钥分发BB84协议\citep{bennett2014quantum}的正确性\citep{baltazar2008quantum,baltazar2007towards}。类似地，在在引入外源量子命题逻辑后，Paulo Mateus等人则研究了量子线性时序逻辑(Quantum Linear-time temporal Logic，或QLTL)的模型检测问题\citep{mateus2009temporal}。Timothy Davidson等人将量子通信协议在量子通信进程(Communicating Quantum Processes，或CQP)\citep{gay2005communicating}中建模，并检测了由QCTL指定的相关属性\citep{davidson2012formal,davidson2012model}。
Simon J. Gay等人还开发了用于量子通信协议的模型检测工具QMC\citep{Gay,gay2010specification}，但其应用限于必须建模为量子电路的协议,才能在Stabilizer code\citep{gottesman1997stabilizer}中形式表示。Ebrahim Ardeshir-Larijani等人则将此技术扩展到Stabilizer code之外，用于检测量子协议的等效性\citep{ardeshir2013equivalence,ardeshir2014verification}。

此外，模型检测技术也被应用于一般量子系统的检测，包括物理系统和量子程序。Mingsheng Ying等人采用量子自动机(Quantum Automata，或QA)作为系统模型\citep{kondacs1997power}，在Birkhoff-von Neumann量子逻辑\citep{birkhoff1987logic}的基础上提出了一种检测某些线性时间属性的方法\citep{ying2014model}。Yangjia Li等人在此基础上研究了量子自动机的可达性问题\citep{li2014decidable}。Shenggang Ying等人还研究了量子马尔科夫链(Quantum Markov Chains)\citep{ying2013verification}和量子马尔科夫决策过程的模型检测问题，并提出了一种分解马尔科夫链的新量子图理论\citep{ying2013reachability,ying2018reachability}。Yuan Feng等人引入超算子值马尔科夫链概念，作为量子程序和通信协议的高级模型，并开发了检测一系列属性的算法\citep{feng2013model,feng2013reachability,feng2017model}。此外，Yuan Feng等人还开发了一个基于概率模型检测工具Iscas Mc\citep{hahn2014iscas}的量子程序和协议的模型检测工具QPMA\citep{feng2015qpmc}。

随着量子计算硬件规模的快速增长，量子电路的验证成为一个重要问题。开始的研究主要集中在二元决策图(Binary Decision Diagrams, 或BDD)在量子计算下的推广算法，如量子信息决策图(Quantum Information Decision Diagram，或QuIDD)\citep{Viamontes_2003}，量子多值决策图(Quantum multiple-valued Decision Diagram，或QMDD)\citep{Seiter_2013}等，从而对组合式量子电路进行等效性检测。显然，随着越来越复杂的物理可实现化的硬件出现，将会出现更加复杂的，更加针对于的，新的验证问题。比如量子存储\citep{Kerckhoff_2010}，量子反馈网络\citep{Gough_2008}，重复至成功(Repeated Until Success，或RUS)的量子电路\citep{Bocharov_2015}。量子模型检测的高度自动化为量子电路的验证提供了更多便利。


未来量子模型检测的最重要目标是寻找一类更简单易于检测的属性。过去的研究追求的是普遍性，即只针对检测量子系统的一般可达性和时间逻辑属性。然而，为了实现这一目标，模型检测的效率非常低，且仅适用于非常小规模和深度较小的量子电路。因此，需要确定一类更简单易于检测的属性，以便当前的量子模型检测工具可以高效地进行检测\citep{ying2021model}。
这需要更多在时序逻辑上的研究工作。但同时更实用的模型检测工具也能在研究相关属性起到一定帮助。

% \subsection{国外研究进展}
% \subsection{国内研究进展}

% \begin{itemize}
%   \item 量子计算的兴起与发展：简要介绍量子计算的历史和发展趋势。
%   \item 量子模型检测的重要性：介绍量子模型检测在量子计算领域中的重要性。(todo: 重要性)
%   \item TDD技术的引入：描述Tensor Decision Diagrams（TDD）技术的引入背景及其在量子计算中的潜在应用。
% \end{itemize}


\section{研究目的和重要性}
% \begin{itemize}
%   \item 研究动机：研究课题的原因，包括现有研究中存在的问题或空白。
%   \item 研究目标：列出研究实现的具体目标。
%   \item 预期影响：讨论研究对于学术界和实际应用可能产生的影响。
% \end{itemize}
本次研究的主要目的是借助最新的数据结构TDD实现模型检测，即利用TDD自动化地验证量子系统的状态是否满足给定的属性。
比如在量子计算中的自动设计领域(Quantum Design Automation, 或QDA)中有大量验证问题，具体来说是对同一算法的不同仿真(synthesis)方案是否等价。比如一类RUS(Repeat Until Success)电路等价性问题。
图\ref{fig:rus-equal}展示了两个RUS量子电路。当电路中测量门结果为$00$时，第三个比特的输出态均为$\left(I+2iZ\right)/ \sqrt 5 |\psi\rangle$。这样的等价性检验任务，可以转换为模型检测中的可达空间是否一致。
\begin{figure}[!htbp]
	\centering
	\begin{subfigure}[b]{0.4\textwidth}
        \centering
        \includegraphics[height=3cm]{Img/rus_s.pdf}
	\end{subfigure}
	\qquad
	\begin{subfigure}[b]{0.4\textwidth}
        \centering
        \includegraphics[height=3cm]{Img/rus_T.pdf}
	\end{subfigure}
	\caption{两个等价的RUS电路\citep{Bocharov_2015}}
	\label{fig:rus-equal}
\end{figure}
未来能够将本研究成果应用于不同的 synthesis 算法的验证等价性中，
从而加速量子算法在实际量子计算机上的实现，进一步在量子计算的实际应用中发挥更大的作用。
\section{论文结构概述}
% \begin{itemize}
%   \item 章节安排：简单概述论文的结构和每一章的主要内容。
%   \item 研究方法概述：预览将采用的研究方法和技术路线。
%   \item 论文贡献：简述研究对现有知识体系的补充或扩展。
% \end{itemize}

\subsection*{主要工作内容}
本次研究中，首先调研了TDD在量子线路表示的优势，然后设计了量子模型检测中所需要的基础算法，最后进行了数值实验，分析量子模型检测中应用TDD表示的可行性。
具体的工作内容如下：
\begin{enumerate}
    \item TDD是一种基于张量网络的决策图模型。与Google的tensor network计算包相比较计算资源增长速度明显比较小。而与类似的QMDD技术相比较，计算资源相近。但是由于TDD比较灵活的与各类优化技术结合，在加入简单的电路优化技术后，TDD的表示好于QMDD。
    \item 在量子模型检测中，子空间的表示以及子空间的并是比较重要的内容。因此本次研究中，首先设计了基于TDD的对子空间进行基分解的算法，然后设计了基于TDD的子空间的并算法。
    \item 在量子模型检测中，一步迁移指的是在已知当前系统状态的情况下，计算系统下一步的状态。一步迁移是量子模型检测中非常重要的一步。
\end{enumerate}
\subsection*{论文结构}